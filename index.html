<!DOCTYPE html>
<html lang="pt-BR">
<head>
 <meta charset="UTF-8">
 <meta name="viewport" content="width=device-width, initial-scale=1.0">
 <title>Sistema de Ficha Técnica de Cozinha</title>
 <link rel="icon" href="./favicon.svg" type="image/svg+xml">
 <script src="https://cdn.tailwindcss.com?plugins=forms,typography,aspect-ratio,line-clamp"></script>
 <script>
 tailwind.config = {
 theme: {
 extend: {
 fontFamily: {
 'sans': ['Inter', 'system-ui', 'sans-serif'],
 }
 }
 }
 }
 </script>
 <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
 <script src="https://unpkg.com/lucide@latest"></script>
 <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
 
 <!-- Firebase SDK -->
 <script type="module">
 import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.12.4/firebase-app.js';
 import { getFirestore, collection, addDoc, getDocs, doc, updateDoc, deleteDoc, query, orderBy, where, onSnapshot } from 'https://www.gstatic.com/firebasejs/10.12.4/firebase-firestore.js';
 import { getAuth, signInAnonymously, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/10.12.4/firebase-auth.js';
 
 // Configuração do Firebase
 const firebaseConfig = {
 apiKey: "AIzaSyCvjYUQr1xvTskO1ZZqGHKi1d1SysvGWLc",
 authDomain: "cozinha-inteligente-2b040.firebaseapp.com",
 projectId: "cozinha-inteligente-2b040",
 storageBucket: "cozinha-inteligente-2b040.firebasestorage.app",
 messagingSenderId: "350206574229",
 appId: "1:350206574229:web:1e525a795d69e3dbd9259c"
 };
 
 // Inicializar Firebase
 const app = initializeApp(firebaseConfig);
 const firestore = getFirestore(app);
 const firebaseAuth = getAuth(app);
 
 // Tornar disponível globalmente
 window.firebaseServices = { 
 db: firestore, 
 auth: firebaseAuth, 
 collection, 
 addDoc, 
 getDocs, 
 doc, 
 updateDoc, 
 deleteDoc, 
 query, 
 orderBy, 
 where, 
 signInAnonymously, 
 onAuthStateChanged, 
 onSnapshot 
 };
 
 // Disparar evento quando Firebase estiver pronto
 window.dispatchEvent(new CustomEvent('firebaseReady'));
 </script>
 
 <style>
 body { font-family: 'Inter', sans-serif; }
 .view { display: none; }
 .view.active { display: block; }
 .sidebar-link.active { background-color: #FFFBEB; color: #D97706; border-right: 3px solid #F97316; }
 @media print {
 body * { visibility: hidden; }
 #printableArea, #printableArea * { visibility: visible; }
 #printableArea { position: absolute; left: 0; top: 0; width: 100%; }
 }
 .loading-overlay {
 position: fixed;
 top: 0;
 left: 0;
 right: 0;
 bottom: 0;
 background: rgba(0, 0, 0, 0.5);
 z-index: 9999;
 display: none;
 align-items: center;
 justify-content: center;
 }
 .modal {
 display: none;
 position: fixed;
 z-index: 10000;
 left: 0;
 top: 0;
 width: 100%;
 height: 100%;
 background-color: rgba(0, 0, 0, 0.5);
 overflow-y: auto;
 }
 .modal-content {
 background-color: white;
 margin: 2% auto;
 border-radius: 8px;
 box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
 width: 90%;
 max-width: 800px;
 max-height: 90vh;
 overflow-y: auto;
 }
 .modal-header {
 display: flex;
 justify-content: space-between;
 align-items: center;
 padding: 1.5rem 2rem;
 border-bottom: 1px solid #e5e7eb;
 }
 .modal-body {
 padding: 2rem;
 }
 .tab-content {
 margin-top: 1rem;
 }
 .active-tab {
 color: #f97316 !important;
 border-bottom-color: #f97316 !important;
 }
 </style>
</head>
<body class="bg-gray-50 text-gray-800">



 <!-- Loading Indicator -->
 <div id="loadingIndicator" class="loading-overlay">
 <div class="bg-white p-6 rounded-lg shadow-lg flex items-center space-x-3">
 <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-orange-500"></div>
 <span class="text-gray-800">Carregando dados...</span>
 </div>
 </div>





 <div class="flex min-h-screen">
 <!-- Sidebar -->
 <aside class="w-64 bg-white shadow-md flex-shrink-0 flex flex-col">
 <div class="p-6 flex items-center space-x-3 border-b border-gray-200">
 <i data-lucide="chef-hat" class="h-10 w-10 text-orange-500"></i>
 <div>
 <h1 class="text-xl font-bold text-gray-800">Cozinha Inteligente</h1>
 <p class="text-xs text-gray-500">v2.0 Firebase Edition</p>
 </div>
 </div>
 <nav class="mt-6 flex-grow">
 <a href="#" onclick="showView('dashboard')" class="sidebar-link active flex items-center px-6 py-3 text-gray-600 hover:bg-gray-100">
 <i data-lucide="layout-dashboard" class="h-5 w-5 mr-3"></i><span>Dashboard</span>
 </a>
 <a href="#" onclick="showView('relatorios')" class="sidebar-link flex items-center px-6 py-3 text-gray-600 hover:bg-gray-100">
 <i data-lucide="line-chart" class="h-5 w-5 mr-3"></i><span>Relatórios</span>
 </a>
 <a href="#" onclick="showView('pratos')" class="sidebar-link flex items-center px-6 py-3 text-gray-600 hover:bg-gray-100">
 <i data-lucide="utensils-crossed" class="h-5 w-5 mr-3"></i><span>Pratos</span>
 </a>
 <a href="#" onclick="showView('fichas')" class="sidebar-link flex items-center px-6 py-3 text-gray-600 hover:bg-gray-100">
 <i data-lucide="notebook-tabs" class="h-5 w-5 mr-3"></i><span>Fichas Técnicas</span>
 </a>
 <a href="#" onclick="showView('insumos')" class="sidebar-link flex items-center px-6 py-3 text-gray-600 hover:bg-gray-100">
 <i data-lucide="carrot" class="h-5 w-5 mr-3"></i><span>Insumos</span>
 </a>
 <a href="#" onclick="showView('importacao')" class="sidebar-link flex items-center px-6 py-3 text-gray-600 hover:bg-gray-100">
 <i data-lucide="file-up" class="h-5 w-5 mr-3"></i><span>Importação</span>
 </a>
 </nav>
 <div class="p-6 border-t border-gray-200">
 <a href="#" onclick="showView('configuracoes')" class="sidebar-link flex items-center px-6 py-3 text-gray-600 hover:bg-gray-100">
 <i data-lucide="cog" class="h-5 w-5 mr-3"></i><span>Configurações</span>
 </a>
 </div>
 </aside>

 <!-- Main Content -->
 <main class="flex-grow p-4 sm:p-6 lg:p-8 bg-gray-100">

 <!-- Dashboard View -->
 <div id="dashboard" class="view active">
 <div class="flex items-center justify-between mb-6">
 <h2 class="text-3xl font-bold text-gray-900">Dashboard de Análises</h2>
 </div>
 
 <!-- Stats Cards -->
 <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
 <div class="bg-white p-6 rounded-lg shadow-md">
 <div class="flex items-center">
 <div class="p-3 rounded-full bg-blue-100">
 <i data-lucide="package" class="h-6 w-6 text-blue-600"></i>
 </div>
 <div class="ml-4">
 <p class="text-sm font-medium text-gray-600">Total de Insumos</p>
 <p id="totalInsumos" class="text-2xl font-bold text-gray-900">0</p>
 </div>
 </div>
 </div>
 
 <div class="bg-white p-6 rounded-lg shadow-md">
 <div class="flex items-center">
 <div class="p-3 rounded-full bg-green-100">
 <i data-lucide="notebook-tabs" class="h-6 w-6 text-green-600"></i>
 </div>
 <div class="ml-4">
 <p class="text-sm font-medium text-gray-600">Fichas Técnicas</p>
 <p id="totalFichas" class="text-2xl font-bold text-gray-900">0</p>
 </div>
 </div>
 </div>
 
 <div class="bg-white p-6 rounded-lg shadow-md">
 <div class="flex items-center">
 <div class="p-3 rounded-full bg-purple-100">
 <i data-lucide="utensils-crossed" class="h-6 w-6 text-purple-600"></i>
 </div>
 <div class="ml-4">
 <p class="text-sm font-medium text-gray-600">Total de Pratos</p>
 <p id="totalPratos" class="text-2xl font-bold text-gray-900">0</p>
 </div>
 </div>
 </div>
 
 <div class="bg-white p-6 rounded-lg shadow-md">
 <div class="flex items-center">
 <div class="p-3 rounded-full bg-orange-100">
 <i data-lucide="shopping-cart" class="h-6 w-6 text-orange-600"></i>
 </div>
 <div class="ml-4">
 <p class="text-sm font-medium text-gray-600">Total de Compras</p>
 <p id="totalCompras" class="text-2xl font-bold text-gray-900">0</p>
 </div>
 </div>
 </div>
 </div>

 <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
 <div class="bg-white p-6 rounded-lg shadow-md">
 <h3 class="text-xl font-semibold mb-4 flex items-center text-gray-800">
 <i data-lucide="trending-up" class="h-6 w-6 mr-3 text-orange-500"></i>Fichas com Maiores Variações
 </h3>
 <div class="relative h-80">
 <canvas id="dashboardFichasChart"></canvas>
 </div>
 </div>
 <div class="bg-white p-6 rounded-lg shadow-md">
 <h3 class="text-xl font-semibold mb-4 flex items-center text-gray-800">
 <i data-lucide="bar-chart-3" class="h-6 w-6 mr-3 text-orange-500"></i>Insumos com Maiores Variações
 </h3>
 <div class="relative h-80">
 <canvas id="dashboardInsumosChart"></canvas>
 </div>
 </div>
 </div>
 </div>
 
 <!-- Outras views continuam iguais... -->
 <div id="insumos" class="view">
 <h2 class="text-3xl font-bold mb-6 text-gray-900">Lista de Insumos</h2>
 <div class="bg-white p-6 rounded-lg shadow-md">
 <div class="flex flex-col sm:flex-row justify-between items-center mb-4 gap-4">
 <h3 class="text-xl font-semibold text-gray-800">Gestão de Insumos</h3>
 <div class="flex items-center gap-2 flex-wrap">
                 <button onclick="showAddInsumoModal()" class="bg-orange-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-orange-700 flex items-center shadow-sm transition-colors text-sm">
                    <i data-lucide="plus" class="h-4 w-4 mr-2"></i>Adicionar Insumo
                </button>
                <button onclick="exportarInsumosCSV()" class="bg-gray-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-gray-700 flex items-center shadow-sm transition-colors text-sm">
 <i data-lucide="download" class="h-4 w-4 mr-2"></i>Exportar CSV
 </button>
 <select id="filterFornecedor" onchange="renderInsumos()" class="border border-gray-300 rounded-lg py-2 px-3 text-sm focus:ring-orange-500 focus:border-orange-500">
 <option value="">Todos os Fornecedores</option>
 </select>
 <select id="filterUnidade" onchange="renderInsumos()" class="border border-gray-300 rounded-lg py-2 px-3 text-sm focus:ring-orange-500 focus:border-orange-500">
 <option value="">Todas as Unidades</option>
 </select>
 <div class="relative">
 <input type="text" id="searchInput" onkeyup="renderInsumos()" placeholder="Buscar insumo..." class="pl-10 pr-4 py-2 border border-gray-300 rounded-lg w-full sm:w-64 focus:ring-orange-500 focus:border-orange-500">
 <i data-lucide="search" class="absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400"></i>
 </div>
 </div>
 </div>
 <div class="overflow-x-auto">
 <table class="w-full text-left">
 <thead class="bg-gray-100">
 <tr>
 <th class="p-4 font-semibold text-gray-600">Nome do Insumo</th>
 <th class="p-4 font-semibold text-gray-600">Unidade Padrão</th>
 <th class="p-4 font-semibold text-gray-600">Taxa de Perca (%)</th>
 <th class="p-4 font-semibold text-gray-600">Último Fornecedor</th>
 <th class="p-4 font-semibold text-gray-600">Último Preço</th>
 <th class="p-4 font-semibold text-gray-600">Data da Compra</th>
 <th class="p-4 font-semibold text-gray-600">Ações</th>
 </tr>
 </thead>
 <tbody id="insumosTableBody"></tbody>
 </table>
 </div>
 </div>
 </div>

 <!-- Views placeholder para outras seções -->
 <div id="relatorios" class="view">
 <h2 class="text-3xl font-bold mb-6 text-gray-900">Relatórios Gerenciais</h2>
 
 <!-- Filtros de Período -->
 <div class="bg-white p-6 rounded-lg shadow-md mb-6">
 <h3 class="text-xl font-semibold mb-4 text-gray-800">Filtros de Período</h3>
 <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
 <div>
 <label for="dataInicio" class="block text-sm font-medium text-gray-700 mb-2">Data Início</label>
 <input type="date" id="dataInicio" class="w-full border border-gray-300 rounded-lg py-2 px-3 focus:ring-orange-500 focus:border-orange-500">
 </div>
 <div>
 <label for="dataFim" class="block text-sm font-medium text-gray-700 mb-2">Data Fim</label>
 <input type="date" id="dataFim" class="w-full border border-gray-300 rounded-lg py-2 px-3 focus:ring-orange-500 focus:border-orange-500">
 </div>
 <div class="flex items-end">
 <button onclick="gerarRelatorios()" class="w-full bg-orange-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-orange-700 flex items-center justify-center">
 <i data-lucide="bar-chart-3" class="h-5 w-5 mr-2"></i>Gerar Relatórios
 </button>
 </div>
 </div>
 </div>

 <!-- Cards de Resumo -->
 <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
 <div class="bg-white p-6 rounded-lg shadow-md">
 <div class="flex items-center">
 <div class="p-3 rounded-full bg-blue-100">
 <i data-lucide="shopping-cart" class="h-6 w-6 text-blue-600"></i>
 </div>
 <div class="ml-4">
 <p class="text-sm font-medium text-gray-600">Total Compras</p>
 <p id="relatorioTotalCompras" class="text-2xl font-bold text-gray-900">R$ 0,00</p>
 </div>
 </div>
 </div>
 
 <div class="bg-white p-6 rounded-lg shadow-md">
 <div class="flex items-center">
 <div class="p-3 rounded-full bg-green-100">
 <i data-lucide="trending-up" class="h-6 w-6 text-green-600"></i>
 </div>
 <div class="ml-4">
 <p class="text-sm font-medium text-gray-600">Ticket Médio</p>
 <p id="relatorioTicketMedio" class="text-2xl font-bold text-gray-900">R$ 0,00</p>
 </div>
 </div>
 </div>
 
 <div class="bg-white p-6 rounded-lg shadow-md">
 <div class="flex items-center">
 <div class="p-3 rounded-full bg-purple-100">
 <i data-lucide="package" class="h-6 w-6 text-purple-600"></i>
 </div>
 <div class="ml-4">
 <p class="text-sm font-medium text-gray-600">Insumos Ativos</p>
 <p id="relatorioInsumosAtivos" class="text-2xl font-bold text-gray-900">0</p>
 </div>
 </div>
 </div>
 
 <div class="bg-white p-6 rounded-lg shadow-md">
 <div class="flex items-center">
 <div class="p-3 rounded-full bg-orange-100">
 <i data-lucide="users" class="h-6 w-6 text-orange-600"></i>
 </div>
 <div class="ml-4">
 <p class="text-sm font-medium text-gray-600">Fornecedores</p>
 <p id="relatorioFornecedores" class="text-2xl font-bold text-gray-900">0</p>
 </div>
 </div>
 </div>
 </div>

 <!-- Gráficos -->
 <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
 <div class="bg-white p-6 rounded-lg shadow-md">
 <h3 class="text-xl font-semibold mb-4 flex items-center text-gray-800">
 <i data-lucide="pie-chart" class="h-6 w-6 mr-3 text-orange-500"></i>Distribuição por Fornecedor
 </h3>
 <div class="relative h-80">
 <canvas id="relatorioFornecedoresChart"></canvas>
 </div>
 </div>
 
 <div class="bg-white p-6 rounded-lg shadow-md">
 <h3 class="text-xl font-semibold mb-4 flex items-center text-gray-800">
 <i data-lucide="bar-chart-2" class="h-6 w-6 mr-3 text-orange-500"></i>Evolução de Gastos
 </h3>
 <div class="relative h-80">
 <canvas id="relatorioEvolucaoChart"></canvas>
 </div>
 </div>
 </div>

 <!-- Tabela de Análise de Preços -->
 <div class="bg-white p-6 rounded-lg shadow-md mb-6">
 <div class="flex justify-between items-center mb-4">
 <h3 class="text-xl font-semibold text-gray-800">Análise de Variação de Preços</h3>
 <button onclick="exportarRelatorioCSV()" class="bg-gray-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-gray-700 flex items-center">
 <i data-lucide="download" class="h-4 w-4 mr-2"></i>Exportar CSV
 </button>
 </div>
 <div class="overflow-x-auto">
 <table class="w-full text-left">
 <thead class="bg-gray-100">
 <tr>
 <th class="p-4 font-semibold text-gray-600">Insumo</th>
 <th class="p-4 font-semibold text-gray-600">Preço Atual</th>
 <th class="p-4 font-semibold text-gray-600">Preço Anterior</th>
 <th class="p-4 font-semibold text-gray-600">Variação</th>
 <th class="p-4 font-semibold text-gray-600">% Variação</th>
 <th class="p-4 font-semibold text-gray-600">Status</th>
 </tr>
 </thead>
 <tbody id="relatorioVariacaoTableBody">
 <tr>
 <td colspan="6" class="text-center p-4 text-gray-500">Clique em "Gerar Relatórios" para ver os dados</td>
 </tr>
 </tbody>
 </table>
 </div>
 </div>

 <!-- Ranking de Fornecedores -->
 <div class="bg-white p-6 rounded-lg shadow-md">
 <h3 class="text-xl font-semibold mb-4 text-gray-800">Ranking de Fornecedores por Volume</h3>
 <div class="overflow-x-auto">
 <table class="w-full text-left">
 <thead class="bg-gray-100">
 <tr>
 <th class="p-4 font-semibold text-gray-600">Posição</th>
 <th class="p-4 font-semibold text-gray-600">Fornecedor</th>
 <th class="p-4 font-semibold text-gray-600">Total Compras</th>
 <th class="p-4 font-semibold text-gray-600">Qtd. Itens</th>
 <th class="p-4 font-semibold text-gray-600">Última Compra</th>
 </tr>
 </thead>
 <tbody id="relatorioFornecedoresTableBody">
 <tr>
 <td colspan="5" class="text-center p-4 text-gray-500">Clique em "Gerar Relatórios" para ver os dados</td>
 </tr>
 </tbody>
 </table>
 </div>
 </div>
 </div>

 <div id="pratos" class="view">
 <h2 class="text-3xl font-bold mb-6 text-gray-900">Pratos Finais</h2>
 
 <!-- Botão Adicionar Prato -->
 <div class="mb-6">
 <button onclick="showModal('pratoModal')" class="bg-orange-600 text-white px-6 py-3 rounded-lg hover:bg-orange-700 transition-colors flex items-center">
 <i data-lucide="plus" class="h-5 w-5 mr-2"></i>
 Adicionar Prato
 </button>
 </div>

 <!-- Filtros -->
 <div class="bg-white p-6 rounded-lg shadow-md mb-6">
 <div class="flex flex-wrap gap-4 items-center">
 <div class="flex-1 min-w-64">
 <input type="text" id="filtroPrato" placeholder="Buscar pratos..." 
 class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"
 oninput="filtrarPratos()">
 </div>
 <div>
 <select id="filtroCategoriaPrato" onchange="filtrarPratos()" 
 class="px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500">
 <option value="">Todas as categorias</option>
 <option value="entrada">Entrada</option>
 <option value="prato-principal">Prato Principal</option>
 <option value="sobremesa">Sobremesa</option>
 <option value="bebida">Bebida</option>
 <option value="acompanhamento">Acompanhamento</option>
 </select>
 </div>
 <div>
 <select id="filtroStatusPrato" onchange="filtrarPratos()" 
 class="px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500">
 <option value="">Todos os status</option>
 <option value="ativo">Ativo</option>
 <option value="inativo">Inativo</option>
 <option value="sazonal">Sazonal</option>
 </select>
 </div>
 </div>
 </div>

 <!-- Lista de Pratos -->
 <div class="bg-white rounded-lg shadow-md">
 <div class="overflow-x-auto">
 <table class="w-full">
 <thead class="bg-gray-50">
 <tr>
 <th class="px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Prato</th>
 <th class="px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Categoria</th>
 <th class="px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Preço</th>
 <th class="px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Custo</th>
 <th class="px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Margem</th>
 <th class="px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
 <th class="px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Ações</th>
 </tr>
 </thead>
 <tbody id="pratosTableBody" class="bg-white divide-y divide-gray-200">
 <!-- Pratos serão inseridos aqui via JavaScript -->
 </tbody>
 </table>
 </div>
 </div>

 <!-- Modal Adicionar/Editar Prato -->
 <div id="pratoModal" class="modal">
 <div class="modal-content">
 <div class="modal-header">
 <h3 id="pratoModalTitle" class="text-xl font-semibold">Adicionar Prato</h3>
 <button onclick="hideModal('pratoModal')" class="text-gray-400 hover:text-gray-600">
 <i data-lucide="x" class="h-6 w-6"></i>
 </button>
 </div>
 <div class="modal-body">
 <form id="pratoForm" onsubmit="savePrato(event)">
 <input type="hidden" id="pratoId">
 
 <!-- Informações Básicas -->
 <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
 <div>
 <label class="block text-sm font-medium text-gray-700 mb-2">Nome do Prato *</label>
 <input type="text" id="pratoNome" required 
 class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500">
 </div>
 <div>
 <label class="block text-sm font-medium text-gray-700 mb-2">Categoria *</label>
 <select id="pratoCategoria" required 
 class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500">
 <option value="">Selecione uma categoria</option>
 <option value="entrada">Entrada</option>
 <option value="prato-principal">Prato Principal</option>
 <option value="sobremesa">Sobremesa</option>
 <option value="bebida">Bebida</option>
 <option value="acompanhamento">Acompanhamento</option>
 </select>
 </div>
 </div>

 <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
 <div>
 <label class="block text-sm font-medium text-gray-700 mb-2">Preço de Venda (R$) *</label>
 <input type="number" id="pratoPreco" step="0.01" min="0" required 
 class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500">
 </div>
 <div>
 <label class="block text-sm font-medium text-gray-700 mb-2">Tempo de Preparo (min)</label>
 <input type="number" id="pratoTempoPreparo" min="0" 
 class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500">
 </div>
 <div>
 <label class="block text-sm font-medium text-gray-700 mb-2">Porções</label>
 <input type="number" id="pratoPorcoes" min="1" value="1" 
 class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500">
 </div>
 </div>

 <div class="mb-6">
 <label class="block text-sm font-medium text-gray-700 mb-2">Descrição</label>
 <textarea id="pratoDescricao" rows="3" 
 class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"
 placeholder="Descrição do prato..."></textarea>
 </div>

                <!-- Configurações de Preparo -->
                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-3">Configurações de Preparo</label>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Custos de Produção (%)</label>
                            <input type="number" id="pratoCustoFinalizacao" step="0.1" min="0" 
                                   class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"
                                   placeholder="Ex: 10.0">
                            <small class="text-gray-500">Custos adicionais (gás, energia, mão de obra, etc.)</small>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Margem de Lucro (%)</label>
                            <input type="number" id="pratoMargemLucro" step="0.1" min="0" 
                                   class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"
                                   placeholder="Ex: 30.0">
                            <small class="text-gray-500">Margem de lucro para precificação de venda</small>
                        </div>
                    </div>
                    <div class="mt-2">
                        <button type="button" onclick="aplicarConfiguracoesDefault()" 
                                class="text-sm text-blue-600 hover:text-blue-800 underline">
                            Aplicar configurações padrão
                        </button>
                    </div>
                </div> <!-- Componentes do Prato -->
 <div class="mb-6">
 <label class="block text-sm font-medium text-gray-700 mb-3">Componentes do Prato</label>
 
 <!-- Tabs para Fichas Técnicas e Insumos -->
 <div class="mb-4">
 <div class="flex border-b border-gray-200">
 <button type="button" id="tabFichas" onclick="switchTab('fichas')" 
 class="px-4 py-2 text-sm font-medium text-gray-500 border-b-2 border-transparent hover:text-gray-700 hover:border-gray-300 active-tab">
 Fichas Técnicas
 </button>
 <button type="button" id="tabInsumos" onclick="switchTab('insumos')" 
 class="px-4 py-2 text-sm font-medium text-gray-500 border-b-2 border-transparent hover:text-gray-700 hover:border-gray-300">
 Insumos Individuais
 </button>
 </div>
 </div>
 
 <!-- Fichas Técnicas -->
 <div id="fichasTab" class="tab-content">
 <div id="fichasList" class="space-y-3 mb-4">
 <!-- Fichas técnicas serão adicionadas aqui -->
 </div>
 <button type="button" onclick="addFichaTecnica()" 
 class="bg-blue-100 text-blue-700 px-4 py-2 rounded-lg hover:bg-blue-200 transition-colors flex items-center">
 <i data-lucide="plus" class="h-4 w-4 mr-2"></i>
 Adicionar Ficha Técnica
 </button>
 </div>
 
 <!-- Insumos Individuais -->
 <div id="insumosTab" class="tab-content" style="display: none;">
 <div id="ingredientesList" class="space-y-3 mb-4">
 <!-- Ingredientes serão adicionados aqui -->
 </div>
 <button type="button" onclick="addIngrediente()" 
 class="bg-gray-100 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-200 transition-colors flex items-center">
 <i data-lucide="plus" class="h-4 w-4 mr-2"></i>
 Adicionar Insumo
 </button>
 </div>
 </div>

 <!-- Status -->
 <div class="mb-6">
 <label class="block text-sm font-medium text-gray-700 mb-2">Status</label>
 <select id="pratoStatus" 
 class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500">
 <option value="ativo">Ativo</option>
 <option value="inativo">Inativo</option>
 <option value="sazonal">Sazonal</option>
 </select>
 </div>

 <!-- Botões -->
 <div class="flex justify-end space-x-3">
 <button type="button" onclick="hideModal('pratoModal')" 
 class="px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50">
 Cancelar
 </button>
 <button type="submit" 
 class="px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700">
 Salvar Prato
 </button>
 </div>
 </form>
 </div>
 </div>
 </div>
 </div>

 <div id="fichas" class="view">
 <h2 class="text-3xl font-bold mb-6 text-gray-900">Fichas Técnicas</h2>
 
 <!-- Botão Adicionar Ficha Técnica -->
 <div class="mb-6">
 <button onclick="showModal('fichaModal')" class="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors flex items-center">
 <i data-lucide="plus" class="h-5 w-5 mr-2"></i>
 Adicionar Ficha Técnica
 </button>
 </div>

 <!-- Filtros -->
 <div class="bg-white p-6 rounded-lg shadow-md mb-6">
 <div class="flex flex-wrap gap-4 items-center">
 <div class="flex-1 min-w-64">
 <input type="text" id="filtroFicha" placeholder="Buscar fichas técnicas..." 
 class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
 oninput="filtrarFichas()">
 </div>
 <div>
 <select id="filtroTipoFicha" onchange="filtrarFichas()" 
 class="px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
 <option value="">Todos os tipos</option>
 <option value="base">Preparação Base</option>
 <option value="molho">Molho</option>
 <option value="acompanhamento">Acompanhamento</option>
 <option value="sobremesa">Sobremesa</option>
 <option value="bebida">Bebida</option>
 </select>
 </div>
 <div>
 <select id="filtroStatusFicha" onchange="filtrarFichas()" 
 class="px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
 <option value="">Todos os status</option>
 <option value="ativo">Ativo</option>
 <option value="inativo">Inativo</option>
 <option value="teste">Em Teste</option>
 </select>
 </div>
 </div>
 </div>

 <!-- Lista de Fichas Técnicas -->
 <div class="bg-white rounded-lg shadow-md">
 <div class="overflow-x-auto">
 <table class="w-full">
 <thead class="bg-gray-50">
 <tr>
 <th class="px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Ficha Técnica</th>
 <th class="px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Tipo</th>
 <th class="px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Rendimento</th>
 <th class="px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Custo Total</th>
 <th class="px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Custo/Porção</th>
 <th class="px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
 <th class="px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Ações</th>
 </tr>
 </thead>
 <tbody id="fichasTableBody" class="bg-white divide-y divide-gray-200">
 <!-- Fichas técnicas serão inseridas aqui via JavaScript -->
 </tbody>
 </table>
 </div>
 </div>

 <!-- Modal Adicionar/Editar Ficha Técnica -->
 <div id="fichaModal" class="modal">
 <div class="modal-content">
 <div class="modal-header">
 <h3 id="fichaModalTitle" class="text-xl font-semibold">Adicionar Ficha Técnica</h3>
 <button onclick="hideModal('fichaModal')" class="text-gray-400 hover:text-gray-600">
 <i data-lucide="x" class="h-6 w-6"></i>
 </button>
 </div>
 <div class="modal-body">
 <form id="fichaForm" onsubmit="saveFicha(event)">
 <input type="hidden" id="fichaId">
 
 <!-- Informações Básicas -->
 <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
 <div>
 <label class="block text-sm font-medium text-gray-700 mb-2">Nome da Ficha Técnica *</label>
 <input type="text" id="fichaNome" required 
 class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
 </div>
 <div>
 <label class="block text-sm font-medium text-gray-700 mb-2">Tipo *</label>
 <select id="fichaTipo" required 
 class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
 <option value="">Selecione um tipo</option>
 <option value="base">Preparação Base</option>
 <option value="molho">Molho</option>
 <option value="acompanhamento">Acompanhamento</option>
 <option value="sobremesa">Sobremesa</option>
 <option value="bebida">Bebida</option>
 </select>
 </div>
 </div>

 <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
 <div>
 <label class="block text-sm font-medium text-gray-700 mb-2">Rendimento *</label>
 <input type="number" id="fichaRendimento" step="0.01" min="0" required 
 class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
 </div>
 <div>
 <label class="block text-sm font-medium text-gray-700 mb-2">Unidade</label>
 <input type="text" id="fichaUnidade" placeholder="kg, L, porções..." 
 class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
 </div>
 <div>
 <label class="block text-sm font-medium text-gray-700 mb-2">Tempo de Preparo (min)</label>
 <input type="number" id="fichaTempoPreparo" min="0" 
 class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
 </div>
 </div>

 <div class="mb-6">
 <label class="block text-sm font-medium text-gray-700 mb-2">Modo de Preparo</label>
 <textarea id="fichaModoPreparo" rows="4" 
 class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
 placeholder="Descreva o modo de preparo..."></textarea>
 </div>

                <!-- Configurações de Preparo -->
                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-3">Configurações de Preparo</label>
                    <div class="grid grid-cols-1 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Custos de Produção (%)</label>
                            <input type="number" id="fichaCustoFinalizacao" step="0.1" min="0" 
                                   class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <small class="text-gray-500">Custos adicionais (gás, energia, mão de obra, etc.)</small>
                        </div>
                    </div>
                    <div class="mt-2">
                        <button type="button" onclick="aplicarConfiguracoesDefaultFicha()" 
                                class="text-sm text-blue-600 hover:text-blue-800 underline">
                            Aplicar configurações padrão
                        </button>
                    </div>
                </div> <!-- Ingredientes -->
 <div class="mb-6">
 <label class="block text-sm font-medium text-gray-700 mb-3">Ingredientes</label>
 <div id="fichaIngredientesList" class="space-y-3 mb-4">
 <!-- Ingredientes serão adicionados aqui -->
 </div>
 <button type="button" onclick="addIngredienteFicha()" 
 class="bg-gray-100 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-200 transition-colors flex items-center">
 <i data-lucide="plus" class="h-4 w-4 mr-2"></i>
 Adicionar Ingrediente
 </button>
 </div>

 <!-- Status -->
 <div class="mb-6">
 <label class="block text-sm font-medium text-gray-700 mb-2">Status</label>
 <select id="fichaStatus" 
 class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
 <option value="ativo">Ativo</option>
 <option value="inativo">Inativo</option>
 <option value="teste">Em Teste</option>
 </select>
 </div>

 <!-- Botões -->
 <div class="flex justify-end space-x-3">
 <button type="button" onclick="hideModal('fichaModal')" 
 class="px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50">
 Cancelar
 </button>
 <button type="submit" 
 class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700">
 Salvar Ficha Técnica
 </button>
 </div>
 </form>
 </div>
 </div>
 </div>
 </div>

 <div id="importacao" class="view">
 <h2 class="text-3xl font-bold mb-6 text-gray-900">Importação XML DANF-e</h2>
 
 <!-- Upload Area -->
 <div class="bg-white p-6 rounded-lg shadow-md mb-6">
 <div class="border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-blue-400 transition-colors" id="uploadArea">
 <i data-lucide="file-up" class="h-12 w-12 mx-auto text-gray-400 mb-4"></i>
 <h3 class="text-lg font-medium text-gray-900 mb-2">Importar XML DANF-e</h3>
 <p class="text-gray-500 mb-4">Arraste o arquivo XML aqui ou clique para selecionar</p>
 <input type="file" id="xmlFileInput" accept=".xml" class="hidden">
 <button type="button" onclick="document.getElementById('xmlFileInput').click()" 
 class="bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700">
 Selecionar Arquivo
 </button>
 </div>
 </div>

 <!-- Processing Status -->
 <div id="processingStatus" class="bg-white p-6 rounded-lg shadow-md mb-6 hidden">
 <div class="flex items-center">
 <div class="animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600 mr-3"></div>
 <span class="text-gray-700">Processando XML...</span>
 </div>
 </div>

 <!-- Import Results -->
 <div id="importResults" class="bg-white p-6 rounded-lg shadow-md hidden">
 <h3 class="text-lg font-semibold text-gray-900 mb-4">Itens Encontrados na Nota</h3>
 <div class="mb-4 p-4 bg-gray-50 rounded-lg">
 <h4 class="font-medium text-gray-900 mb-2">Informações da Nota</h4>
 <div id="notaInfo" class="text-sm text-gray-600 space-y-1"></div>
 </div>
 
 <div class="overflow-x-auto">
 <table class="min-w-full divide-y divide-gray-200">
 <thead class="bg-gray-50">
 <tr>
 <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">Item</th>
 <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">Descrição</th>
 <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">Qtd</th>
 <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">Valor Unit.</th>
 <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">Status</th>
 <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">Insumo Vinculado</th>
 <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">Ações</th>
 </tr>
 </thead>
 <tbody id="itensImportacao" class="bg-white divide-y divide-gray-200">
 </tbody>
 </table>
 </div>
 
 <div class="mt-6 flex justify-end space-x-3">
 <button type="button" onclick="cancelarImportacao()" 
 class="px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50">
 Cancelar
 </button>
 <button type="button" onclick="confirmarImportacao()" 
 class="px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700">
 Confirmar Importação
 </button>
 </div>
 </div>

 <!-- Histórico de Importações -->
 <div class="bg-white p-6 rounded-lg shadow-md">
 <h3 class="text-lg font-semibold text-gray-900 mb-4">Histórico de Importações</h3>
 <div class="overflow-x-auto">
 <table class="min-w-full divide-y divide-gray-200">
 <thead class="bg-gray-50">
 <tr>
 <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">Data</th>
 <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">Fornecedor</th>
 <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">Nota</th>
 <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">Itens</th>
 <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">Valor Total</th>
 <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase">Ações</th>
 </tr>
 </thead>
 <tbody id="historicoImportacoes" class="bg-white divide-y divide-gray-200">
 </tbody>
 </table>
 </div>
 </div>
 </div>

 <div id="configuracoes" class="view">
 <h2 class="text-3xl font-bold mb-6 text-gray-900">Configurações</h2>
 <div class="bg-white p-6 rounded-lg shadow-md max-w-lg mx-auto">
 <div class="space-y-6">
 <div>
 <h3 class="text-lg font-medium text-gray-900">Configurações Padrão</h3>
 <div class="mt-4 space-y-4">
 <div>
 <label for="defaultTaxaPerca" class="block text-sm font-medium text-gray-700">Taxa de Perca Padrão (%)</label>
 <input type="number" id="defaultTaxaPerca" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:ring-orange-500 focus:border-orange-500">
 <small class="text-gray-500">Valor padrão para taxa de perca ao cadastrar novos insumos</small>
 </div>
 <div>
 <label for="defaultCustoFinalizacao" class="block text-sm font-medium text-gray-700">Custos de Produção Padrão (%)</label>
 <input type="number" id="defaultCustoFinalizacao" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:ring-orange-500 focus:border-orange-500">
 <small class="text-gray-500">Valor padrão para custos de produção ao cadastrar novas fichas técnicas e pratos</small>
 </div>
 <div>
                     <label for="defaultMargemLucro" class="block text-sm font-medium text-gray-700">Margem de Lucro Padrão (%) - Apenas para Pratos</label>
 <input type="number" id="defaultMargemLucro" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:ring-orange-500 focus:border-orange-500">
 </div>
 </div>
 </div>
 </div>
 <div class="mt-8 text-right">
 <button onclick="salvarConfiguracoes()" class="bg-blue-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-blue-700 flex items-center shadow-sm transition-colors inline-flex">
 <i data-lucide="save" class="h-5 w-5 mr-2"></i>Salvar Configurações
 </button>
 </div>
 </div>
 </div>
 </main>
 </div>

         </div>
    </div>
    </main>
</div>

<!-- Modal Adicionar/Editar Insumo -->
<div id="insumoModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3 id="insumoModalTitle" class="text-xl font-semibold">Adicionar Insumo</h3>
            <button onclick="hideModal('insumoModal')" class="text-gray-400 hover:text-gray-600">
                <i data-lucide="x" class="h-6 w-6"></i>
            </button>
        </div>
        <div class="modal-body">
            <form id="insumoForm" onsubmit="saveInsumo(event)">
                <input type="hidden" id="insumoId">
                
                <!-- Informações Básicas -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Nome do Insumo *</label>
                        <input type="text" id="insumoNome" required 
                               class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Unidade Padrão *</label>
                        <select id="insumoUnidade" required 
                                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500">
                            <option value="">Selecione uma unidade</option>
                            <option value="kg">Quilograma (kg)</option>
                            <option value="g">Grama (g)</option>
                            <option value="L">Litro (L)</option>
                            <option value="ml">Mililitro (ml)</option>
                            <option value="unidade">Unidade</option>
                            <option value="maço">Maço</option>
                            <option value="dúzia">Dúzia</option>
                            <option value="pacote">Pacote</option>
                            <option value="lata">Lata</option>
                        </select>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-1 gap-4 mb-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Taxa de Perca Padrão (%)</label>
                        <input type="number" id="insumoTaxaPerca" step="0.1" min="0" max="100" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"
                               placeholder="Ex: 5.0">
                        <small class="text-gray-500">Taxa de perda típica deste insumo durante o preparo</small>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-1 gap-4 mb-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Categoria</label>
                        <select id="insumoCategoria" 
                                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500">
                            <option value="">Selecione uma categoria</option>
                            <option value="carnes">Carnes</option>
                            <option value="vegetais">Vegetais</option>
                            <option value="frutas">Frutas</option>
                            <option value="laticinios">Laticínios</option>
                            <option value="graos">Grãos e Cereais</option>
                            <option value="temperos">Temperos e Especiarias</option>
                            <option value="oleos">Óleos e Gorduras</option>
                            <option value="massas">Massas</option>
                            <option value="enlatados">Enlatados</option>
                            <option value="bebidas">Bebidas</option>
                            <option value="outros">Outros</option>
                        </select>
                    </div>
                </div>

                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Observações</label>
                    <textarea id="insumoObservacoes" rows="3" 
                              class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500"
                              placeholder="Informações adicionais sobre o insumo, características especiais, etc."></textarea>
                </div>

                <!-- Botões -->
                <div class="flex justify-end space-x-3">
                    <button type="button" onclick="hideModal('insumoModal')" 
                            class="px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50">
                        Cancelar
                    </button>
                    <button type="submit" 
                            class="px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700">
                        Salvar Insumo
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Modal Vincular Insumo -->
<div id="vincularInsumoModal" class="modal">
    <div class="modal-content max-w-2xl">
        <div class="modal-header">
            <h2 class="text-xl font-semibold text-gray-900">Vincular Item ao Insumo</h2>
            <button type="button" onclick="closeVincularInsumoModal()" class="text-gray-400 hover:text-gray-600">
                <i data-lucide="x" class="h-6 w-6"></i>
            </button>
        </div>
        
        <div class="modal-body">
            <div id="itemInfo" class="mb-6 p-4 bg-gray-50 rounded-lg">
                <!-- Informações do item serão preenchidas aqui -->
            </div>
            
            <div class="mb-6">
                <label class="block text-sm font-medium text-gray-700 mb-2">Escolha uma opção:</label>
                <div class="space-y-3">
                    <label class="flex items-center">
                        <input type="radio" name="vinculacaoOpcao" value="existente" class="mr-2" onchange="toggleVinculacaoOpcao()">
                        <span>Vincular a insumo existente</span>
                    </label>
                    <label class="flex items-center">
                        <input type="radio" name="vinculacaoOpcao" value="novo" class="mr-2" onchange="toggleVinculacaoOpcao()">
                        <span>Criar novo insumo</span>
                    </label>
                    <label class="flex items-center">
                        <input type="radio" name="vinculacaoOpcao" value="ignorar" class="mr-2" onchange="toggleVinculacaoOpcao()">
                        <span>Ignorar este item</span>
                    </label>
                </div>
            </div>
            
            <!-- Seleção de Insumo Existente -->
            <div id="insumoExistenteSection" class="mb-6 hidden">
                <label class="block text-sm font-medium text-gray-700 mb-2">Selecionar Insumo Existente</label>
                <select id="insumoExistenteSelect" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500">
                    <option value="">Selecione um insumo...</option>
                </select>
            </div>
            
            <!-- Formulário para Novo Insumo -->
            <div id="novoInsumoSection" class="mb-6 hidden">
                <h3 class="text-lg font-medium text-gray-900 mb-4">Criar Novo Insumo</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Nome do Insumo</label>
                        <input type="text" id="novoInsumoNome" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Unidade</label>
                        <select id="novoInsumoUnidade" 
                                class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500">
                            <option value="kg">Quilograma (kg)</option>
                            <option value="g">Grama (g)</option>
                            <option value="l">Litro (l)</option>
                            <option value="ml">Mililitro (ml)</option>
                            <option value="un">Unidade (un)</option>
                            <option value="cx">Caixa (cx)</option>
                            <option value="pc">Pacote (pc)</option>
                            <option value="dz">Dúzia (dz)</option>
                            <option value="sc">Saco (sc)</option>
                            <option value="bd">Bandeja (bd)</option>
                            <option value="fr">Fardo (fr)</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Categoria</label>
                        <input type="text" id="novoInsumoCategoria" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Taxa de Perda (%)</label>
                        <input type="number" id="novoInsumoTaxaPerda" step="0.01" min="0" max="100" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500">
                    </div>
                </div>
            </div>
            
            <!-- Conversão de Unidades -->
            <div id="conversaoUnidadesSection" class="mb-6 bg-blue-50 p-4 rounded-lg">
                <h4 class="text-md font-medium text-gray-900 mb-4 flex items-center">
                    <i data-lucide="calculator" class="h-4 w-4 mr-2"></i>
                    Conversão de Unidades
                </h4>
                
                <!-- Primeira linha: Dados originais e conversão básica -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-4 mb-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Quantidade da Nota Fiscal</label>
                        <div class="flex">
                            <input type="number" id="quantidadeOriginal" step="0.001" readonly
                                   class="flex-1 px-3 py-2 border border-gray-300 rounded-l-lg bg-gray-100 focus:outline-none text-center">
                            <select id="unidadeOriginal" onchange="aplicarConversaoAutomatica()"
                                    class="w-20 px-2 py-2 bg-white border border-l-0 border-gray-300 rounded-r-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm">
                                <option value="kg">kg</option>
                                <option value="g">g</option>
                                <option value="l">l</option>
                                <option value="ml">ml</option>
                                <option value="un">un</option>
                                <option value="cx">cx</option>
                                <option value="pc">pc</option>
                                <option value="dz">dz</option>
                                <option value="sc">sc</option>
                                <option value="bd">bd</option>
                                <option value="fr">fr</option>
                            </select>
                        </div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Converter Para</label>
                        <div class="flex">
                            <input type="number" id="quantidadeConvertida" step="0.001" 
                                   class="flex-1 px-3 py-2 border border-gray-300 rounded-l-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-center"
                                   onchange="calcularConversao()">
                            <select id="unidadeConvertida" onchange="aplicarConversaoAutomatica()"
                                    class="w-20 px-2 py-2 bg-white border border-l-0 border-gray-300 rounded-r-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm">
                                <option value="kg">kg</option>
                                <option value="g">g</option>
                                <option value="l">l</option>
                                <option value="ml">ml</option>
                                <option value="un">un</option>
                                <option value="cx">cx</option>
                                <option value="pc">pc</option>
                                <option value="dz">dz</option>
                                <option value="sc">sc</option>
                                <option value="bd">bd</option>
                                <option value="fr">fr</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <!-- Segunda linha: Conversão personalizada e valor ajustado -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-4 mb-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            Peso/Volume por Unidade 
                            <span class="text-xs text-gray-500">(para conversões personalizadas)</span>
                        </label>
                        <div class="flex">
                            <input type="number" id="pesoUnidade" step="0.001" placeholder="Ex: 500"
                                   class="flex-1 px-3 py-2 border border-gray-300 rounded-l-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-center"
                                   onchange="aplicarConversaoPersonalizada()">
                            <select id="unidadePeso" onchange="aplicarConversaoPersonalizada()"
                                    class="w-16 px-1 py-2 bg-white border border-l-0 border-gray-300 rounded-r-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm">
                                <option value="g">g</option>
                                <option value="kg">kg</option>
                                <option value="ml">ml</option>
                                <option value="l">l</option>
                            </select>
                        </div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Valor Unitário Ajustado</label>
                        <div class="flex">
                            <span class="px-3 py-2 bg-gray-200 border border-gray-300 rounded-l-lg text-sm font-medium">R$</span>
                            <input type="number" id="valorUnitarioConvertido" step="0.01" readonly
                                   class="flex-1 px-3 py-2 border border-l-0 border-gray-300 rounded-r-lg bg-gray-100 focus:outline-none text-center font-medium text-green-700">
                        </div>
                    </div>
                </div>
                
                <!-- Terceira linha: Informações de resultado -->
                <div class="bg-white rounded-lg p-3 border border-gray-200">
                    <div class="grid grid-cols-1 sm:grid-cols-3 gap-4 text-sm">
                        <div class="text-center">
                            <div class="text-gray-500">Fator de Conversão</div>
                            <div class="font-bold text-blue-600" id="fatorConversao">1</div>
                        </div>
                        <div class="text-center">
                            <div class="text-gray-500">Valor Total</div>
                            <div class="font-bold text-green-600">R$ <span id="valorTotalConvertido">0.00</span></div>
                        </div>
                        <div class="text-center">
                            <div class="text-gray-500">Tipo de Conversão</div>
                            <div class="font-medium text-gray-700" id="tipoConversao">Sem conversão</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Edição de Dados do Insumo Existente -->
            <div id="edicaoInsumoExistenteSection" class="mb-6 hidden bg-green-50 p-4 rounded-lg">
                <h4 class="text-md font-medium text-gray-900 mb-3 flex items-center">
                    <i data-lucide="edit" class="h-4 w-4 mr-2"></i>
                    Editar Dados do Insumo
                </h4>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Nome do Insumo</label>
                        <input type="text" id="editarInsumoNome" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Categoria</label>
                        <input type="text" id="editarInsumoCategoria" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Taxa de Perda (%)</label>
                        <input type="number" id="editarInsumoTaxaPerda" step="0.01" min="0" max="100" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Fornecedor</label>
                        <input type="text" id="editarInsumoFornecedor" 
                               class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500">
                    </div>
                </div>
                <div class="mt-3">
                    <label class="flex items-center">
                        <input type="checkbox" id="salvarAlteracoesInsumo" class="mr-2">
                        <span class="text-sm text-gray-700">Salvar alterações permanentemente no insumo</span>
                    </label>
                </div>
            </div>
            
            <div class="flex justify-end space-x-3">
                <button type="button" onclick="closeVincularInsumoModal()" 
                        class="px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50">
                    Cancelar
                </button>
                <button type="button" onclick="confirmarVinculacao()" 
                        class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700">
                    Confirmar
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Print Area -->
 <div id="printableArea" style="display: none;"></div>

 <!-- Include the main JavaScript here -->
 <script src="js/main.js"></script>
</body>
</html>
